#include <iostream>
#include <windows.h>
#include "tad.h"
#include<string>
#include<string.h>

using namespace std;

void animation(){

    cout<<PlaySound((LPCSTR)"C:\intro.wav",NULL,SND_FILENAME | SND_ASYNC);
    system("cls");
	cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
	_sleep(100);
    system("cls");
	cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .       **  .";
	cout<<"\n       .           .           .           .           .           .           . **   ";
	cout<<"\n .           .           .           .           .           .           .       **  .";
	cout<<"\n       .           .           .           .           .           .           . **** ";
	cout<<"\n .           .           .           .           .           .           .       ****.";
	cout<<"\n       .           .           .           .           .           .           . **   ";
	cout<<"\n .           .           .           .           .           .           .       **  .";
	cout<<"\n       .           .           .           .           .           .           . **   ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
    system("color 70");
	_sleep(870);
    system("cls");
    cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .          **       **   ";
	cout<<"\n       .           .           .           .           .           .    **       **  *";
	cout<<"\n .           .           .           .           .           .          **     . **  *";
	cout<<"\n       .           .           .           .           .           .    ***********  *";
	cout<<"\n .           .           .           .           .           .          ***********  *";
	cout<<"\n       .           .           .           .           .           .    **       **  *";
	cout<<"\n .           .           .           .           .           .          **  .    **  *";
	cout<<"\n       .           .           .           .           .           .    **       **   ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
	system("color 07");
	_sleep(800);
    system("cls");
    cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           **       **   *********  ";
	cout<<"\n       .           .           .           .           .     **       **  *********** ";
	cout<<"\n .           .           .           .           .           **     . **  **       ** ";
	cout<<"\n       .           .           .           .           .     ***********  **       ** ";
	cout<<"\n .           .           .           .           .           ***********  **       ** ";
	cout<<"\n       .           .           .           .           .     **       **  **       ** ";
	cout<<"\n .           .           .           .           .           **  .    **  *********** ";
	cout<<"\n       .           .           .           .           .     **       **   *********  ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
	system("color 1E");
	_sleep(620);
    system("cls");
    cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .        **       **   *********   **            ";
	cout<<"\n       .           .           .           .  **       **  ***********  **            ";
	cout<<"\n .           .           .           .        **     . **  **       **  **            ";
	cout<<"\n       .           .           .           .  ***********  **       **  **           *";
	cout<<"\n .           .           .           .        ***********  **       **  **           *";
	cout<<"\n       .           .           .           .  **       **  **       **  **           *";
	cout<<"\n .           .           .           .        **  .    **  ***********  ***********  *";
	cout<<"\n       .           .           .           .  **       **   *********   ***********  *";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
    system("color FD");
    _sleep(500);
    system("cls");
    cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .       **       **   *********   **             *******     ";
	cout<<"\n       .           .           . **       **  ***********  **            **     **    ";
	cout<<"\n .           .           .       **     . **  **       **  **            **     **    ";
	cout<<"\n       .           .           . ***********  **       **  **           ***********   ";
	cout<<"\n .           .           .       ***********  **       **  **           ***********   ";
	cout<<"\n       .           .           . **       **  **       **  **           **       **   ";
	cout<<"\n .           .           .       **  .    **  ***********  ***********  **       **   ";
	cout<<"\n       .           .           . **       **   *********   ***********  **       **   ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------";
    system("color C0");
    _sleep(500);
    system("cls");
    cout<<"\n--------------------------------------------------------------------------------------";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .     **       **   *********   **             *******      .           .";
	cout<<"\n       .           **       **  ***********  **            **     **           .      ";
	cout<<"\n .           .     **     . **  **       **  **            **     **     .           .";
	cout<<"\n       .           ***********  **       **  **           ***********          .      ";
	cout<<"\n .           .     ***********  **       **  **           ***********    .           .";
	cout<<"\n       .           **       **  **       **  **           **       **          .      ";
	cout<<"\n .           .     **  .    **  ***********  ***********  **       **    .           .";
	cout<<"\n       .           **       **   *********   ***********  **       **          .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n .           .           .           .           .           .           .           .";
	cout<<"\n       .           .           .           .           .           .           .      ";
	cout<<"\n--------------------------------------------------------------------------------------\n";
    system("color 71");
    _sleep(260);
    system("color 90");
    _sleep(200);
    system("color 41");
    _sleep(200);
	system("color 70");
	_sleep(4);
	system("color 07");
	_sleep(4);
	system("color 70");
	_sleep(4);
	system("color 07");
	_sleep(4);
	system("color 70");
	_sleep(4);
	system("color 07");
	_sleep(4);
    for(int i=0;i<3;i++){
	    system("color 30");
		_sleep(90);
		system("color 07");
		_sleep(90);
		system("color 1E");
		_sleep(90);
	    system("color FD");
	    _sleep(90);
	    system("color C0");
	    _sleep(90);
	    system("color 51");
	    _sleep(90);
	    system("color 90");
	    _sleep(90);
	    system("color A1");
	    _sleep(90);
	    system("color 70");
    	_sleep(90);
	}
}

//funcion para ordenar alfabeticamente los productos
void order_alphabetically(warehouse x){
	int size=x.size_of();
	node *p=x.get_first();
	char names[size][55];
    char temporal_char[55];
	for(int i=0;i<size;i++){
		strcpy(names[i],p->data.name);
		p=p->next;
	}
	for(int i=0;i<size;i++){
	    for(int j=i;j<size;j++){
	    	if (strcmp(names[i],names[j])>0){
	    		strcpy(temporal_char,names[i]);
	    		strcpy(names[i],names[j]);
	    		strcpy(names[j],temporal_char);	
	    	}
	    }
    }
	warehouse temp;
	product aux;
    p=x.get_first();
    for(int i=0;i<size;i++){
   		for(int j=0;j<size;j++){
   			aux=p->data;
			if(strcmp(names[i],aux.name)==0){
				temp.add(aux);
				j=size;
			}
			p=p->next;
		}
	}
	printf("La lista ordenada es: \n");
	temp.show();
}

//funcion para ordenar por precio los productos
void order_by_price(warehouse x){
	int size=x.size_of();
	node *p=x.get_first();
	double prices[size];
    double temporal_double;
	for(int i=0;i<size;i++){
		prices[i]=p->data.price;
		p=p->next;
	}
	for(int i=0;i<size;i++){
	    for(int j=i;j<size;j++){
	    	if ((prices[i] > prices[j])){
	    		temporal_double=prices[i];
	    		prices[i]=prices[j];
	    		prices[j]=temporal_double;
	    	}
		}
	}
	warehouse temp;
	product aux;
    p=x.get_first();
    for(int i=0;i<size;i++){
   		for(int j=0;j<size;j++){
   			aux=p->data;
			if(p->data.price == prices[i]){
				temp.add(aux);
				j=size;
			}
			p=p->next;
		}
	}
	printf("La lista ordenada por precio es: \n");
	temp.show();
}

int main(){
	node *p;
	bool res=false;
	product new_p;
	warehouse list_of_products;
	int count, id, option;
	string type, brand;
	node* pd;
	system("TITLE Warehouse program");
	animation();
    system("pause");
	do{
		system("cls");
		cout<<"--------------------------------OPCIONES--------------------------------\n";
		printf("\n1.\tInsertar producto.\n2.\tMostrar productos.\n3.\tOrdenar alfabeticamente.\n4.\tFiltrar por tipo de producto.\n5.\tFiltrar productos por marca.\n6.\tEliminar por ID.\n7.\tVender un producto.\n8.\tMostrar la cantidad de productos por tipo.\n9.\tMostrar un producto por ID.\n10.\tEditar un producto.\n11.\tOrdenar por precio.\n12.\tMostrar los ultimos 5 productos del almacen.\n0.\tSalir\n\n Digita una opci%cn: ",162);
		cin>>option;
		Beep(900,70);
		switch(option){
			case 1: 
				system("cls");
				cout<<"--------------------------------INSERTAR PRODUCTO--------------------------------\n";
				fflush(stdin);
				printf("\nIngresa el nombre: ");gets(new_p.name);
				fflush(stdin);
				printf("\nIngresa la marca: ");getline(cin,new_p.brand);
				printf("\nIngresa el tipo de producto: ");getline(cin,new_p.type);
				fflush(stdin);
				do{
					printf("\nIngresa la ID del producto: ");cin>>id;
					pd = list_of_products.search_id(id);
	    			if(pd->data.id!=-1000){
	    				cout<<"\nesa ID ya esta registrada en el almacen, por favor, ingrese otra id "<<endl;
						system("pause");
						Beep(900,70);
						res=false;
					}else{
						res=true;
					}
				}while(!res);
				new_p.id=id;
				printf("\nIngresa el precio del producto: ");cin>>new_p.price;
				printf("\nIngresa la cantidad de productos a agregar: ");cin>>new_p.amount;
				list_of_products.add(new_p);
				cout<<"\n------------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
				break;
			case 2:
				system("cls");
				cout<<"------------------------------MOSTRAR PRODUCTOS------------------------------\n";
				printf("\n\n la lista de los productos es: ");
				list_of_products.show();
				cout<<"\n---------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
				break;
			case 3:
				system("cls");
				cout<<"---------------------------ORDENAR ALFABETICAMENTE---------------------------\n";
				order_alphabetically(list_of_products);
				cout<<"\n---------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 4: 
				system("cls");
				cout<<"------------------------------FILTRAR POR TIPO------------------------------\n";
				fflush(stdin);
				printf("\nIngresa el tipo de articulo que estas buscando: ");getline(cin,type);
				fflush(stdin);
    			printf("\n\n la lista de los productos de tipo ");cout<<type<<" es: "<<endl;
				list_of_products.show_by_type(type);
				cout<<"----------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 5:
				system("cls");
				cout<<"-----------------------------FILTRAR POR MARCA-----------------------------\n";
    			fflush(stdin);
				printf("\nIngresa la marca que estas buscando: ");getline(cin,brand);
				fflush(stdin);
    			printf("\n\n Los siguientes productos que corresponden a la marca ");cout<<brand<<":"<<endl;
				list_of_products.show_by_brand(brand);
				cout<<"---------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 6: 
				system("cls");
				cout<<"------------------------------BORRAR PRODUCTO------------------------------\n";
	    		cout<<"Digite la ID del producto que desea eliminar: ";
	    		cin>>id;
    			list_of_products.delete_by_id(id);
				cout<<"---------------------------------------------------------------------------\n";
				system("pause");
				Beep(900,70);
    			break;
    		case 7:
				system("cls");
				cout<<"----------------------------------VENDER----------------------------------\n";
    			int sold;
				cout<<"Digite la Id:";
				cin>>id;
				cout<<"Digite la cantidad de productos que desea comprar:	";cin>>sold;	
    			list_of_products.sell(id,sold);
				cout<<"\n--------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 8:
				system("cls");
				cout<<"---------------------------------CANTIDAD---------------------------------\n";
    			fflush(stdin);
    			cout << "\nDigite el tipo del producto: "; getline(cin, type);
    			fflush(stdin);
    			count = list_of_products.size_by_type(type);
    			if(count == 0){
    				cout << "No hay productos de ese tipo registrados aun";
				}else{
					cout << "\nHay " << count << " productos de tipo " << type<<endl;
				}
				cout<<"\n--------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 9:
				system("cls");
				cout<<"-----------------------------BUSCAR PRODUCTO-----------------------------\n";
    			fflush(stdin);
    			cout << "\nDigite el ID del producto: "; cin>>id;
    			fflush(stdin);
    			pd = list_of_products.search_id(id);
    			if(pd->data.id==-1000){
    				cout<<"\nAl parecer no se ha registrado ese articulo"<<endl;
				}else{
					pd->data.to_string();
				}
				cout<<"\n\n-------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 10:
    			system("cls");
				cout<<"---------------------EDITAR PRODUCTO---------------------\n";
				cout<<"Insertar la ID del producto a editar: ";
				cin >> id;
				p=list_of_products.search_id(id);
				fflush(stdin);
				printf("\nNuevo nombre: ");gets(p->data.name);
				fflush(stdin);
				printf("\nNueva marca: ");getline(cin,p->data.brand);
				printf("\nNuevo tipo de producto: ");getline(cin,p->data.type);
				fflush(stdin);
				do{
					printf("\nIngresa la Nuevo ID del producto: ");cin>>id;
					pd = list_of_products.search_id(id);
	    			if(pd->data.id!=-1000){
	    				cout<<"\nesa ID ya esta registrada en el almacen, por favor, ingrese otra id "<<endl;
						system("pause");
						res=false;
					}else{
						res=true;
					}
				}while(!res);
				printf("\nIngresa el precio del producto: ");cin>>p->data.price;
				printf("\nIngresa la cantidad de productos a agregar: ");cin>>p->data.amount;
				cout<<"\n--------------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 11:
				system("cls");
				cout<<"--------------------------ORDENAR POR PRECIO--------------------------\n";
    			order_by_price(list_of_products);
				cout<<"\n----------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 12:
				system("cls");
				cout<<"--------------------------5 ULTIMOS PRODUCTOS--------------------------\n";
    			cout<<"\nLos productos mas nuevos son: "<<endl;
    			list_of_products.five_last_added();
				cout<<"\n-----------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
    		case 0:
				system("cls");
				cout<<"----------------------------------------------------------------------\n";
    			printf("\n\nAdi%cs, gracias por usar el programa.\n",162);
				cout<<"\n----------------------------------------------------------------------\n";
    			system("pause");
				Beep(900,70);
    			break;
			default:
				break;
		}
	}while(option!=0);

    return 0; 
}
